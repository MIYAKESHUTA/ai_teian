<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>æ–™ç†ã‚¢ã‚­ãƒãƒ¼ã‚¿ãƒ¼AI</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    button { margin: 10px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h1>æ–™ç†ã‚¢ã‚­ãƒãƒ¼ã‚¿ãƒ¼ AI ğŸ½ï¸</h1>
  <div id="conversation"></div>
  <p id="question">åˆæœŸåŒ–ä¸­...</p>
  <button onclick="sendAnswer('ã¯ã„')">ã¯ã„</button>
  <button onclick="sendAnswer('ã„ã„ãˆ')">ã„ã„ãˆ</button>

  <script>
    let history = [];

    async function fetchReply() {
      const res = await fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ history }),
      });

      const data = await res.json();
      const assistantReply = data.reply.content;

      history.push({ role: "assistant", content: assistantReply });
      document.getElementById("question").textContent = assistantReply;

      const convoDiv = document.getElementById("conversation");
      convoDiv.innerHTML += `<p><strong>AI:</strong> ${assistantReply}</p>`;
    }

    async function sendAnswer(answer) {
      history.push({ role: "user", content: answer });
      const convoDiv = document.getElementById("conversation");
      convoDiv.innerHTML += `<p><strong>ã‚ãªãŸ:</strong> ${answer}</p>`;
      await fetchReply();
    }

    // åˆå›å‘¼ã³å‡ºã—
    fetchReply();
  </script>
</body>
</html>
